<html>
<body>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
const PI     = "3.141592653589793238462643383279502884197169399375105820974944592307816406286208998628034825342117067";
const pi1000 = "3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989";
const width  = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;
const height = window.innerHeight|| document.documentElement.clientHeight|| document.body.clientHeight;

const locations = [[1, 7], [3, 9], [6, 12], [16, 22], [21, 27], [28, 34], [32, 38], [33, 39], [37, 43], [40, 46], [49, 55], [50, 56], [53, 59], [54, 60], [63, 69], [64, 70], [65, 71], [68, 74], [71, 77], [73, 79], [76, 82], [77, 83], [83, 89], [85, 91], [89, 95], [93, 99], [94, 100], [95, 101], [97, 103], [102, 108], [103, 109], [106, 112], [110, 116], [112, 118], [114, 120], [115, 121], [116, 122], [121, 127], [128, 134], [132, 138], [135, 141], [136, 142], [138, 144], [140, 146], [146, 152], [148, 154], [149, 155], [153, 159], [154, 160], [155, 161], [159, 165], [160, 166], [163, 169], [164, 170], [165, 171], [167, 173], [168, 174], [173, 179], [174, 180], [175, 181], [176, 182], [185, 191], [186, 192], [194, 200], [195, 201], [198, 204], [203, 209], [206, 212], [207, 213], [220, 226], [221, 227], [229, 235], [238, 244], [241, 247], [243, 249], [244, 250], [245, 251], [246, 252], [248, 254], [250, 256], [260, 266], [264, 270], [269, 275], [270, 276], [275, 281], [280, 286], [281, 287], [287, 293], [289, 295], [291, 297], [292, 298], [295, 301], [297, 303], [298, 304], [302, 308], [307, 313], [308, 314], [311, 317], [314, 320], [319, 325], [324, 330], [326, 332], [327, 333], [329, 335], [330, 336], [333, 339], [335, 341], [337, 343], [340, 346], [342, 348], [344, 350], [354, 360], [357, 363], [360, 366], [361, 367], [362, 368], [363, 369], [365, 371], [366, 372], [368, 374], [369, 375], [374, 380], [375, 381], [380, 386], [381, 387], [385, 391], [390, 396], [393, 399], [395, 401], [396, 402], [398, 404], [402, 408], [403, 409], [406, 412], [408, 414], [417, 423], [420, 426], [421, 427], [423, 429], [424, 430], [427, 433], [428, 434], [432, 438], [435, 441], [437, 443], [438, 444], [441, 447], [442, 448], [443, 449], [445, 451], [446, 452], [451, 457], [456, 462], [462, 468], [471, 477], [477, 483], [479, 485], [483, 489], [484, 490], [485, 491], [490, 496], [492, 498], [493, 499], [494, 500], [495, 501], [499, 505], [500, 506], [510, 516], [513, 519], [519, 525], [520, 526], [523, 529], [524, 530], [525, 531], [535, 541], [536, 542], [541, 547], [543, 549], [545, 551], [546, 552], [547, 553], [552, 558], [557, 563], [558, 564], [561, 567], [565, 571], [566, 572], [568, 574], [571, 577], [574, 580], [579, 585], [587, 593], [596, 602], [598, 604], [600, 606], [601, 607], [602, 608], [603, 609], [607, 613], [610, 616], [613, 619], [618, 624], [620, 626], [627, 633], [630, 636], [638, 644], [640, 646], [646, 652], [650, 656], [651, 657], [657, 663], [659, 665], [660, 666], [661, 667], [662, 668], [668, 674], [669, 675], [670, 676], [681, 687], [682, 688], [684, 690], [687, 693], [688, 694], [694, 700], [698, 704], [702, 708], [703, 709], [704, 710], [709, 715], [710, 716], [711, 717], [712, 718], [713, 719], [715, 721], [716, 722], [717, 723], [720, 726], [724, 730], [728, 734], [730, 736], [734, 740], [737, 743], [744, 750], [745, 751], [746, 752], [750, 756], [752, 758], [755, 761], [757, 763], [758, 764], [759, 765], [771, 777], [775, 781], [780, 786], [781, 787], [786, 792], [789, 795], [791, 797], [793, 799], [797, 803], [802, 808], [803, 809], [815, 821], [817, 823], [818, 824], [819, 825], [822, 828], [824, 830], [825, 831], [826, 832], [827, 833], [829, 835], [838, 844], [841, 847], [843, 849], [845, 851], [846, 852], [847, 853], [850, 856], [852, 858], [853, 859], [854, 860], [855, 861], [856, 862], [857, 863], [859, 865], [867, 873], [877, 883], [878, 884], [882, 888], [884, 890], [885, 891], [887, 893], [889, 895], [895, 901], [898, 904], [899, 905], [904, 910], [909, 915], [911, 917], [920, 926], [921, 927], [922, 928], [927, 933], [933, 939], [945, 951], [951, 957], [957, 963], [960, 966], [961, 967], [963, 969], [964, 970], [965, 971], [968, 974], [971, 977], [972, 978], [973, 979], [974, 980], [975, 981], [977, 983], [983, 989], [984, 990], [985, 991], [989, 995], [991, 997], [992, 998], [995, 1001]];
window.addEventListener('load', function () {
    console.log('This function is executed once the page is fully loaded');
    console.log(PI);
    placeBraces();
});

var newDiv = document.createElement("div");
newDiv.className = "pi_text";
var newContent = document.createTextNode(pi1000);

newDiv.appendChild(newContent);

var currentDiv = document.getElementById("div1");
document.body.insertBefore(newDiv, currentDiv);

document.onwheel = function(event) {
    if (event.deltaY != 0) {
        window.scrollBy(event.deltaY, 0);
    }
}

//Function from https://stackoverflow.com/questions/43965616/getting-character-width-in-javascript
var calculateWordDimensions = function(text, classes, escape) {
    classes = classes || [];

    if (escape === undefined) {
        escape = true;
    }

    classes.push('textDimensionCalculation');

    var div = document.createElement('div');
    div.setAttribute('class', classes.join(' '));

    div.innerHTML = text;


    document.body.appendChild(div);

    var dimensions = {
        width : jQuery(div).outerWidth(),
        height : jQuery(div).outerHeight()
    };

    div.parentNode.removeChild(div);

    return dimensions;
};

function test() {
var dimensions = calculateWordDimensions('42 is the answer!'); <!--obviously a hitchhikers guide fan, lol --->

console.log(dimensions.width);
};

function placeBars() {
    var inputText = newDiv;
    var innerHTML = inputText.innerHTML;
    var fudgeFactor = 15

    for (var i = 0; i < locations.length; i++) {
        var startIndex = locations[i][0] + 1;
        var stopIndex = locations[i][1] + 1;

        var startStr = innerHTML.substring(0, startIndex);
        var codeStr = innerHTML.substring(startIndex, stopIndex);

        var barPos = calculateWordDimensions(startStr);
        var barWidth = calculateWordDimensions(codeStr).width;

        if (i % 2 == 0) {
            var ypos = (height / 2);
        } else {
            var ypos = (height / 2) + barPos.height;
        }
        generateBar(barPos.width + fudgeFactor, barPos.width + barWidth, ypos);
    }
}

function generateBar(startPoint, endPoint, height) {
    var newBar = "";
    newBar += "<div style='position:absolute;left:";
    newBar += startPoint;
    newBar += "px;top:";
    newBar += height;
    newBar += "px;width:";
    newBar += endPoint - startPoint;
    newBar += "px;height:1px;background:#000'></div>";
    document.body.innerHTML += newBar;
}

function placeBraces() {
    var inputText = newDiv;
    var innerHTML = inputText.innerHTML;
    var fudgeFactor = 15

    var svg = document.createElementNS(null, "svg");

    for (var i = 0; i < locations.length; i++) {
        var startIndex = locations[i][0] + 1;
        var stopIndex = locations[i][1] + 1;

        var startStr = innerHTML.substring(0, startIndex);
        var codeStr = innerHTML.substring(startIndex, stopIndex);
        
        locations[i].push(codeStr);

        var barPos = calculateWordDimensions(startStr);
        var barWidth = calculateWordDimensions(codeStr).width;

        makeCurlyBraceReal(i, barPos.width, barWidth, i % 2 == 1, i % 3);
    }

    newDiv.innerHTML += "";
}

window.onresize = onResizeEvent;

function onResizeEvent() {
    for (var i = 0; i < locations.length; i++) {
        var el = document.getElementById("bracket-" + i);
        el.parentNode.removeChild(el);
    }

    placeBraces();
}	


function makeCurlyBraceReal(id, xpos, width, isBottom, colour){
    var newBrace = document.createElement('img');
    newBrace.setAttribute("src", "bracket.png");
    newBrace.setAttribute("id", "bracket-" + id);
    var style = "";
    style += "position: absolute; top: ";
    if (isBottom) {
        style += 1;
        style += "vmax; transform: rotate(180deg);"
    } else {
        style += -3;
        style += "vmax;";
    }
    style += "left: ";
    style += xpos;
    style += "px;";

    switch (colour) {
        //filtering operations calculated with this tool: https://codepen.io/sosuke/pen/Pjoqqp
        case 1: //red
            style += "filter: invert(19%) sepia(90%) saturate(5578%) hue-rotate(356deg) brightness(105%) contrast(120%);";
            break;
        case 2: //blue
            style += "filter: invert(9%) sepia(99%) saturate(7500%) hue-rotate(248deg) brightness(89%) contrast(144%);";
            break;
        default:
            //do nothing leave them as black
            break;
    }

    newBrace.setAttribute("style", style);
    newBrace.setAttribute("width", width + "px");
    newDiv.appendChild(newBrace);
}
</script>

<style>
body {
    /*overflow: hidden; /* Hide scrollbars */
    min-height: 100%;
    margin: 0;
}

.highlight {
  background-color: yellow;
}

div.pi_text {
    position: absolute;
    top: 50%;
    font-size: 3vmax;
}

.textDimensionCalculation {
    position: absolute;
    visibility: hidden;
    height: auto;
    width: auto;
    white-space: nowrap;
    font-size: 3vmax;
}
</style>

</body>
</html>
